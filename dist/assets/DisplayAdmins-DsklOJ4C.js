import{r as c,j as e,a as b,y as t}from"./index-Ccy8gSAR.js";import{a as f,b as g}from"./index-byKU0jFi.js";import{A as x}from"./api-CiEY4WUz.js";function A(){const[u,o]=c.useState(!1),[h,i]=c.useState([]),[r,d]=c.useState(null),[n,m]=c.useState({name:"",password:""});async function j(){try{o(!0);const{data:s}=await x.get("/admin/get_all_admins");i(s),t.success(s.message),o(!1)}catch{t.error("حدث خطأ أثناء تسجيل الدخول."),o(!1)}}async function p(s){try{await x.delete(`/admin/delete_admin/${s}`),i(a=>a.filter(l=>l._id!==s)),t.success("تم حذف الأدمن بنجاح.")}catch(a){console.error("Error deleting admin:",a),t.error("حدث خطأ أثناء محاولة حذف الأدمن.")}}async function N(){const s={};n.name!==r.name&&(s.name=n.name),n.password&&(s.password=n.password);try{await x.put(`/admin/edit_admin/${r._id}`,s),i(a=>a.map(l=>l._id===r._id?{...l,...s}:l)),t.success("تم تحديث بيانات الأدمن بنجاح."),d(null)}catch(a){console.error("Error updating admin:",a),t.error("حدث خطأ أثناء محاولة تحديث بيانات الأدمن.")}}return c.useEffect(()=>{j()},[]),u?e.jsx(b,{}):e.jsxs("section",{className:"my-3 display-admins",children:[e.jsxs("div",{className:"container",children:[e.jsx("h4",{className:"fw-bold main-color mb-4",children:"جميع المسؤولين:"}),e.jsx("div",{className:"row",children:h.length>0?h.map((s,a)=>e.jsx("div",{className:"col-md-3 mb-4",children:e.jsxs("div",{className:"card shadow-sm",children:[e.jsx("span",{children:a+1}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center pb-2",children:`[ ${s.name} ]`}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{className:"accent-color",children:"الدور:"})," ",s.role]}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{className:"accent-color",children:"تاريخ الإنشاء:"})," ",new Date(s.creationTime).toLocaleDateString("en-EG")]}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{className:"accent-color",children:"الباسورد:"})," ","********"]}),e.jsxs("div",{className:"card-buttons d-flex justify-content-end gap-3 pt-3",children:[e.jsx("button",{className:"btn btn-warning rounded-0 d-flex align-items-center justify-content-center",title:"تعديل",onClick:()=>{d(s),m({name:s.name,password:""})},children:e.jsx(f,{})}),e.jsx("button",{className:"btn btn-danger rounded-0 d-flex align-items-center justify-content-center",title:"حذف",onClick:()=>p(s._id),children:e.jsx(g,{})})]})]})]})},s._id)):e.jsx("div",{className:"col-12 text-center main-color fw-bold",children:e.jsx("p",{children:"لا يوجد بيانات لعرضها "})})})]}),r&&e.jsx("div",{className:"modal show d-block main-color",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"modal-header",children:e.jsx("button",{type:"button",className:"btn-close d-block",onClick:()=>d(null)})}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"adminName",className:"form-label fw-bold",children:"الاسم :"}),e.jsx("input",{type:"text",id:"adminName",className:"form-control",value:n.name,onChange:s=>m({...n,name:s.target.value})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"adminPassword",className:"form-label fw-bold",children:"كلمة المرور الجديدة :"}),e.jsx("input",{type:"password",id:"adminPassword",className:"form-control",placeholder:"ادخل كلمه المرور الجديدة",value:n.password,onChange:s=>m({...n,password:s.target.value})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger rounded-0",onClick:()=>d(null),children:"إلغاء"}),e.jsx("button",{className:"btn btn-primary rounded-0",onClick:N,children:"حفظ التعديلات"})]})]})})})]})}export{A as default};
