import{r as l,A as y,j as t,a as v,L as d,y as m}from"./index-Ccy8gSAR.js";import{a as w,b as C}from"./index-byKU0jFi.js";import{A as x}from"./api-CiEY4WUz.js";import{I as U}from"./placeholder-C5s33bWh.js";const k="http://localhost:4444";function $(){const[j,i]=l.useState(!1),[h,o]=l.useState([]),[r,c]=l.useState(null);let{setAdminAddUserId:b}=l.useContext(y);const[s,_]=l.useState({name:"",last_name:"",national_id:"",birth_date:"",nationality:"",Category:"",file_status:"",result:"",file_number:"",file_open_date:"",file_category:"",result_release_date:"",travel_procedures_date:"",travel_date:""});async function p(){try{i(!0);const{data:e}=await x.get("/admin/get_all_users");o(e),i(!1)}catch(e){console.error("Error fetching users:",e),i(!1)}}function f(e){b(e),localStorage.setItem("AdminSetUserId",e)}async function g(e){try{await x.delete(`/admin/delete_user/${e}`),o(a=>a.filter(n=>n._id!==e))}catch(a){console.error("Error deleting user:",a)}}async function u(){const e={};if(Object.keys(s).forEach(a=>{s[a]!==r[a]&&(e[a]=s[a])}),Object.keys(e).length===0){m.error("لا يوجد تعديلات لإرسالها.");return}try{await x.put(`/admin/edit_user/${r._id}`,e),o(a=>a.map(n=>n._id===r._id?{...n,...e}:n)),m.success("تم تحديث بيانات المستخدم بنجاح."),c(null)}catch(a){console.error("Error updating user:",a),m.error("حدث خطأ أثناء محاولة تحديث بيانات المستخدم.")}}if(l.useEffect(()=>{p()},[]),j)return t.jsx(v,{});const N={name:"الاسم الأول",last_name:"اسم العائلة",national_id:"الرقم القومي",birth_date:"تاريخ الميلاد",nationality:"الجنسية",Category:"الفئة",file_status:"حالة الملف",result:"النتيجة",file_number:"رقم الملف",file_open_date:"تاريخ فتح الملف",file_category:"فئة الملف",result_release_date:"تاريخ إصدار النتيجة",travel_procedures_date:"تاريخ إجراءات السفر",travel_date:"تاريخ السفر"};return t.jsxs("section",{className:"my-3 display-users",children:[t.jsxs("div",{className:"container",children:[t.jsx("h4",{className:"fw-bold main-color mb-4",children:"جميع المستخدمين:"}),t.jsx("div",{className:"row",children:h.length>0?h.map((e,a)=>t.jsx("div",{className:"col-md-6 mb-4",children:t.jsxs("div",{className:"card shadow-sm",onClick:()=>f(e._id),children:[t.jsx("span",{children:a+1}),t.jsx("img",{src:e.image?`${k}${e.image}`:U,alt:e.name||"user-image",className:"card-img-top w-100",style:{objectFit:"cover",height:"400px"}}),t.jsxs("div",{className:"card-body",children:[t.jsx("h5",{className:"card-title text-center pb-2",children:`[ ${e.name} ]`}),t.jsxs("p",{className:"card-text",children:[t.jsx("strong",{className:"accent-color",children:"الرقم القومى:"})," ",e.national_id]}),t.jsxs("p",{className:"card-text",children:[t.jsx("strong",{className:"accent-color",children:"الجنسية:"})," ",e.nationality]}),t.jsxs("p",{className:"card-text",children:[t.jsx("strong",{className:"accent-color",children:"تاريخ الميلاد:"})," ",e.birth_date]}),t.jsxs("p",{className:"card-text",children:[t.jsx("strong",{className:"accent-color",children:"تاريخ الإنشاء:"})," ",new Date(e.creationTime).toLocaleDateString("en-EG")]}),t.jsx("p",{className:"fw-bold text-center text-primary fs-6",children:"[ الاجراءات المتاحه :- اضافة - تعديل - حذف ]"}),t.jsxs("div",{className:"card-buttons d-flex justify-content-center gap-2 py-2",children:[t.jsx(d,{className:"main-bg p-2 text-white text-decoration-none",to:"/add-photo",children:"صورة"}),t.jsx(d,{className:"main-bg p-2 text-white text-decoration-none",to:"/add-info",children:"معلومات دقيقة"}),t.jsx(d,{className:"main-bg p-2 text-white text-decoration-none",to:"/add-members",children:"اضف غضو"}),t.jsx("button",{className:"btn btn-warning rounded-0 d-flex align-items-center justify-content-center",title:"تعديل",onClick:()=>{c(e),_({name:e.name,last_name:e.last_name,national_id:e.national_id,birth_date:e.birth_date,nationality:e.nationality,Category:e.Category,file_status:e.file_status,result:e.result,file_number:e.file_number,file_open_date:e.file_open_date,file_category:e.file_category,result_release_date:e.result_release_date,travel_procedures_date:e.travel_procedures_date,travel_date:e.travel_date})},children:t.jsx(w,{})}),t.jsx("button",{onClick:()=>g(e._id),className:"btn btn-danger rounded-0 d-flex align-items-center justify-content-center",title:"حذف",children:t.jsx(C,{})})]})]})]})},e._id)):t.jsx("div",{className:"col-12 text-center main-color fw-bold",children:t.jsx("p",{children:"لا يوجد بيانات لعرضها"})})})]}),r&&t.jsx("div",{className:"modal show d-block main-color",children:t.jsx("div",{className:"modal-dialog",children:t.jsxs("div",{className:"modal-content",children:[t.jsx("div",{className:"modal-header",children:t.jsx("button",{type:"button",className:"btn-close d-block",onClick:()=>c(null)})}),t.jsx("div",{className:"modal-body",children:Object.keys(s).map(e=>t.jsxs("div",{className:"mb-3",children:[t.jsxs("label",{htmlFor:e,className:"form-label fw-bold",children:[N[e],":"]}),t.jsx("input",{type:"text",id:e,className:"form-control",value:s[e],onChange:a=>_({...s,[e]:a.target.value})})]},e))}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{className:"btn btn-danger rounded-0",onClick:()=>c(null),children:"إلغاء"}),t.jsx("button",{className:"btn btn-primary rounded-0",onClick:u,children:"حفظ التعديلات"})]})]})})})]})}export{$ as default};
