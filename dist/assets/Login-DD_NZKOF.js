import{u as g,r as d,A as p,j as a,a as _,$ as v,y as m}from"./index-Ccy8gSAR.js";import{c as N,a as l,b as y,u as w}from"./formik.esm-D4hxogZ9.js";import{A as C}from"./api-CiEY4WUz.js";import{j as B}from"./index-VWaDGczM.js";function k(){const c=g();let{setUserId:h,setUserRole:u}=d.useContext(p);const[s,t]=d.useState(!1);async function b(f){try{t(!0);let{data:n}=await C.post("/auth/user_login",f);const j=n.token,r=B(j),i=r.id,o=r.role;sessionStorage.setItem("UserId",i),sessionStorage.setItem("UserRole",o),u(o),h(i),m.success(n.message),c("/profile"),t(!1)}catch{m.error("حدث خطأ أثناء تسجيل الدخول."),t(!1)}}const x=N({name:l().min(3,"يجب أن يتكون الاسم الأول من 3 حروف على الأقل").max(15,"الاسم الأول لا يمكن أن يتجاوز 15 حرفًا").required("اسم المستخدم الأول مطلوب"),last_name:l().min(3,"يجب أن يتكون الاسم الثاني من 3 حروف على الأقل").max(15,"الاسم الثاني لا يمكن أن يتجاوز 15 حرفًا").required("اسم المستخدم الثاني مطلوب"),national_id:l().matches(/^\d+$/,"رقم الهوية يجب أن يحتوي على أرقام فقط").required("رقم الهوية مطلوب"),birth_date:y().required("تاريخ الميلاد مطلوب"),nationality:l().required("الجنسية مطلوبة")}),e=w({initialValues:{name:"",last_name:"",national_id:"",birth_date:"",nationality:""},validationSchema:x,onSubmit:b});return s?a.jsx(_,{}):a.jsx(a.Fragment,{children:a.jsxs("section",{className:"login",children:[a.jsx("h4",{className:"main-bg text-center mb-4",children:"تسجيل الدخول"}),a.jsx("div",{className:"container mb-5",children:a.jsx("div",{className:"row justify-content-center",children:a.jsx("div",{className:"col-md-6",children:a.jsxs("form",{onSubmit:e.handleSubmit,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"nationality",className:"form-label fw-bold",children:"الجنسية:"}),a.jsx("input",{type:"text",id:"nationality",name:"nationality",className:"form-control",placeholder:"ادخل الجنسية",value:e.values.nationality,onChange:e.handleChange,onBlur:e.handleBlur}),e.errors.nationality&&e.touched.nationality?a.jsx("div",{className:"alert alert-danger p-2 mt-3",children:e.errors.nationality}):null]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"name",className:"form-label fw-bold",children:"الاسم الاول:"}),a.jsx("input",{type:"text",id:"name",name:"name",className:"form-control",placeholder:"اسم المستخدم الاول",value:e.values.name,onChange:e.handleChange,onBlur:e.handleBlur}),e.errors.name&&e.touched.name?a.jsx("div",{className:"alert alert-danger p-2 mt-3",children:e.errors.name}):null]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"last_name",className:"form-label fw-bold",children:"الاسم الثاني:"}),a.jsx("input",{type:"text",id:"last_name",name:"last_name",className:"form-control",placeholder:"اسم المستخدم الثاني",value:e.values.last_name,onChange:e.handleChange,onBlur:e.handleBlur}),e.errors.last_name&&e.touched.last_name?a.jsx("div",{className:"alert alert-danger p-2 mt-3",children:e.errors.last_name}):null]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"national_id",className:"form-label fw-bold",children:"رقم ID:"}),a.jsx("input",{type:"text",id:"national_id",name:"national_id",className:"form-control",placeholder:"ادخل رقم الهوية",value:e.values.national_id,onChange:e.handleChange,onBlur:e.handleBlur}),e.errors.national_id&&e.touched.national_id?a.jsx("div",{className:"alert alert-danger p-2 mt-3",children:e.errors.national_id}):null]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"birth_date",className:"form-label fw-bold",children:"تاريخ الميلاد:"}),a.jsx("input",{type:"date",id:"birth_date",name:"birth_date",className:"form-control",value:e.values.birth_date,onChange:e.handleChange,onBlur:e.handleBlur}),e.errors.birth_date&&e.touched.birth_date?a.jsx("div",{className:"alert alert-danger p-2 mt-3",children:e.errors.birth_date}):null]}),a.jsx("button",{type:"submit",className:"main-bg text-white border-0 rounded-1 fw-bold py-2 w-100 d-flex justify-content-center",style:{width:"30%",display:"block",margin:"0 auto",border:"none"},disabled:!(e.isValid&&e.dirty),children:s?a.jsx(v,{height:"20",width:"50",color:"#fff",ariaLabel:"bars-loading",visible:!0}):"فتح"})]})})})})]})})}export{k as default};
